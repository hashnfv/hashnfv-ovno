#!/usr/bin/python

import shutil

import setup
setup.pre_install()

from charmhelpers.core import hookenv
from charmhelpers.fetch import (
    configure_sources,
    apt_upgrade,
    apt_install,
)

PACKAGES = [ "contrail-web-controller", "nodejs",
             "supervisor", "contrail-utils" ]

def install():
    hookenv.log('Installing contrail-webui')

    # set apt preferences
    shutil.copy('files/40contrail', '/etc/apt/preferences.d')

    configure_sources(True, "install-sources", "install-keys")
    apt_upgrade(fatal=True, dist=True)
    apt_install(PACKAGES, fatal=True)
    setup.fix_services()

if __name__ == "__main__":
    install()
